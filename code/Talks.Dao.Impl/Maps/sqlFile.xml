<?xml version="1.0" encoding="utf-8" ?>
<sqlMap namespace="Ibatis" xmlns="http://ibatis.apache.org/mapping" xmlns:xls="http://www.w3.org/2001/XMLSchema-instance">
  <!--模块配置 配置类的命名空间，不配置则要写全类的命名空间-->
  <alias>
    <typeAlias alias="Product" type="Talks.Model.Product,Talks.Model"/>
  </alias>
  <resultMaps>
    
    <!--Product类与db表的映射-->
    <resultMap id="SelectAllResult" class="Product">
      <result property="ProductID" column="ProductID"/>
      <result property="Name" column="Name"/>
      <result property="Description" column="Description" />
      <result property="Company" column="Company" />
      <result property="Price" column="Price"  />
      <result property="Category" column="Category" />
    </resultMap>
  </resultMaps>
  <statements>
    <sql id="pageSql">
      SELECT
      *
      FROM
      (
      SELECT
      ROW_NUMBER() OVER (ORDER BY {1}) AS DataRowNumber,
      *
      FROM (
      {0}
      ) AS OriginDataTable
      ) AS DataTableWithRowNumber
      WHERE
      DataRowNumber BETWEEN #Start# AND #End#
      ORDER BY
      DataRowNumber ASC;
    </sql>
    <!--SELECT * FROM (SELECT ROW_NUMBER() OVER (ORDER BY {1}) AS DataRowNumber, * FROM ({0}) AS OriginDataTable ) AS DataTableWithRowNumber WHERE DataRowNumber BETWEEN {2} AND {3} ORDER BY DataRowNumber ASC;-->
    <select id="GetALLProduct"    resultMap="SelectAllResult" >
      SELECT
      *
      FROM
      (
      SELECT
      ROW_NUMBER() OVER (ORDER BY {1}) AS DataRowNumber,
      *
      FROM (
      {0}
      ) AS OriginDataTable
      ) AS DataTableWithRowNumber
      WHERE
      DataRowNumber BETWEEN {2} AND {3}
      ORDER BY
      DataRowNumber ASC;
      
      SELECT  *
      FROM Product
    </select>
    <insert  id="InsertProduct"  parameterClass="Product" resultClass="string">
      <![CDATA[
      INSERT INTO  [dbo].[Product]
      ([ProductID]
      ,[Name]
      ,[Description]
      ,[Company]
      ,[Price]
      ,[Category])
      VALUES
      (#ProductID#
      ,#Name#
      ,#Description#
      ,#Company#
      ,#Price#
      ,#Category#)
      
      ]]>
      <selectKey resultClass="string" type="post" property="ProductID" >
        select @@IDENTITY as ProductID
      </selectKey>
    </insert >
    
  </statements>
</sqlMap>